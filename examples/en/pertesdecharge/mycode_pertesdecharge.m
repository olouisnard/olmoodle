%----------------------------------------------------------------------
% Constants
%----------------------------------------------------------------------
g = 9.81 ;

%----------------------------------------------------------------------
% Conversions 
%----------------------------------------------------------------------
Q = Qlperh / 3600 / 1e3 ;
D = Dmm / 1e3 ;
rug = rugmicron / 1e6 ;

S = pi * D.^2/4 ; % Tube section
v = Q ./ S ; % Velocity


%----------------------------------------------------------------------
% Le nombre de Reynolds
%----------------------------------------------------------------------
Re = v .* D .* rho ./ mu ; % Reynolds

epset = rug ./ D ; % Relative rugosity

un_sur_racine_de_f = -1.8 * log10 ( 6.9./Re + (epset/3.7).^1.11);

f = 1 ./ un_sur_racine_de_f.^2; % Friction factor


%----------------------------------------------------------------------
% Head loss
%----------------------------------------------------------------------
hv = f .* L ./ D .* v.^2 / (2*g) ; % Head loss

%----------------------------------------------------------------------
% Required pump power
%----------------------------------------------------------------------
Wpu = rho .* g .* Q .* (hv + h) ; 
